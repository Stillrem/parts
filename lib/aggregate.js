import { fromRepairClinic, fromAppliancePartsPros, fromPartSelect, fromSears, fromEbayAPI, fromAmazonAPI } from './sources.js';
function dedupe(items){const seen=new Set();return items.filter(it=>{const k=[it.supplier||'',it.url||'',it.part_number||'',it.name||''].join('|');if(seen.has(k))return false;seen.add(k);return true})}
export async function aggregate(query){const tasks=[fromRepairClinic(query),fromAppliancePartsPros(query),fromPartSelect(query),fromSears(query),fromEbayAPI(query),fromAmazonAPI(query)];const results=await Promise.allSettled(tasks);let items=[];for(const r of results){if(r.status==='fulfilled')items=items.concat(r.value||[])}return dedupe(items).slice(0,80)}